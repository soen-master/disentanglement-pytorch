0
Pre-Processing CelebA
labels (127817, 10)
All classes percentages: [0.24165017172989509, 0.2910723925612399, 0.21396214900991262, 0.2533152866989524]
Initialized CBM_Join model
## Initializing Train indexes
::path chosen -> logs/celebA__CBM_Join/only_10_latents/0-latents/train_runs
Losses: {'total_vae': tensor(1.4600, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(1.4600, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(1.2767, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(1.2767, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(1.1254, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(1.1254, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[0:1025]  loss_total_vae=1.173  loss_total=0.000  loss_prediction=1.173  loss_true_values=-1.000  loss_total_vae_epoch=1.288  
Losses: {'total_vae': tensor(1.2003, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(1.2003, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(1.0643, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(1.0643, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.8741, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.8741, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[1:2051]  loss_total_vae=0.972  loss_total=0.000  loss_prediction=0.972  loss_true_values=-1.000  loss_total_vae_epoch=1.069  
Losses: {'total_vae': tensor(0.9150, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.9150, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.9009, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.9009, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.8248, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.8248, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[2:3077]  loss_total_vae=0.892  loss_total=0.000  loss_prediction=0.892  loss_true_values=-1.000  loss_total_vae_epoch=0.893  
Losses: {'total_vae': tensor(0.8859, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.8859, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.5990, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.5990, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.6934, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.6934, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[3:4103]  loss_total_vae=0.646  loss_total=0.000  loss_prediction=0.646  loss_true_values=-1.000  loss_total_vae_epoch=0.730  
Losses: {'total_vae': tensor(0.5955, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.5955, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.6508, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.6508, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.5492, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.5492, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[4:5129]  loss_total_vae=0.635  loss_total=0.000  loss_prediction=0.635  loss_true_values=-1.000  loss_total_vae_epoch=0.585  
Losses: {'total_vae': tensor(0.5418, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.5418, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.5190, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.5190, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.4568, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.4568, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[5:6155]  loss_total_vae=0.382  loss_total=0.000  loss_prediction=0.382  loss_true_values=-1.000  loss_total_vae_epoch=0.476  
Losses: {'total_vae': tensor(0.4078, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.4078, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.3833, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.3833, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.3249, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.3249, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[6:7181]  loss_total_vae=0.366  loss_total=0.000  loss_prediction=0.366  loss_true_values=-1.000  loss_total_vae_epoch=0.389  
Losses: {'total_vae': tensor(0.3202, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.3202, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.2975, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2975, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.2686, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2686, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[7:8207]  loss_total_vae=0.274  loss_total=0.000  loss_prediction=0.274  loss_true_values=-1.000  loss_total_vae_epoch=0.312  
Losses: {'total_vae': tensor(0.2493, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2493, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.2806, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2806, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.2412, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2412, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[8:9233]  loss_total_vae=0.248  loss_total=0.000  loss_prediction=0.248  loss_true_values=-1.000  loss_total_vae_epoch=0.274  
Losses: {'total_vae': tensor(0.1855, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1855, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.2170, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2170, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.1341, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1341, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[9:10259]  loss_total_vae=0.236  loss_total=0.000  loss_prediction=0.236  loss_true_values=-1.000  loss_total_vae_epoch=0.273  
Losses: {'total_vae': tensor(0.1870, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1870, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.2121, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2121, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.2110, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.2110, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[10:11285]  loss_total_vae=0.104  loss_total=0.000  loss_prediction=0.104  loss_true_values=-1.000  loss_total_vae_epoch=0.206  
Losses: {'total_vae': tensor(0.1714, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1714, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.1357, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1357, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.1493, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1493, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
[11:12311]  loss_total_vae=0.200  loss_total=0.000  loss_prediction=0.200  loss_true_values=-1.000  loss_total_vae_epoch=0.155  
Losses: {'total_vae': tensor(0.1232, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1232, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.1107, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1107, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 1
Latent 1.463393368372103   1.1190223679309939
BCE 0.4530248347578979 0.41133156665133913
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.1491, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1491, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0728, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0728, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0909, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0909, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0649, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0649, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.1074, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.1074, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 2
Latent 1.5136269922178935   1.2687590731191765
BCE 0.47539691275697415 0.41008432383136695
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.0753, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0753, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0333, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0333, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0186, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0162, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 3
Latent 1.5849211012444846   1.3942025476677955
BCE 0.5354776691372801 0.42888407029595155
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.0546, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0546, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0249, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0249, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0350, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0350, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0103, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0179, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 4
Latent 1.6887662972861188   1.461451114354741
BCE 0.5797769243155069 0.4525125229423285
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.0383, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0383, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0071, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0083, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0082, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 5
Latent 1.677130228135644   1.520647153944827
BCE 0.6538538746232909 0.48796647221738404
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0110, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0202, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0023, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0066, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0062, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Losses: {'total_vae': tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0039, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
Done testing
Now val counter at: 6
Latent 1.7415046003775867   1.5957714635828324
BCE 0.6200188784822216 0.5302171687365871
---Validation stop---
Done testing
Saved test_metrics
Losses: {'total_vae': tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>), 'total': 0, 'prediction': tensor(0.0141, device='cuda:0', grad_fn=<MulBackward0>), 'true_values': tensor(-1)}
